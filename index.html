<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RecycleRight CA – Install the App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#16a34a" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
</head>
<body class="h-full bg-gray-50 flex flex-col items-center justify-center text-center p-6">
  <main class="max-w-md">
    <h1 class="text-4xl font-bold text-green-700 mb-4">RecycleRight&nbsp;CA</h1>
    <p class="text-lg mb-6">Snap &amp; learn where to toss – then earn cash for cans and bottles! Add this web app to your phone in seconds.</p>

    <p id="platformMsg" class="text-sm text-gray-700 mb-4"></p>

    <button id="installBtn" class="hidden px-6 py-3 rounded-lg bg-green-600 text-white font-semibold shadow-lg hover:bg-green-700 transition mb-2">Install App</button>
    <div id="androidHint" class="hidden text-sm text-gray-600 mb-4"><p>In Chrome, tap <span class="font-semibold">⋮ Menu</span> → <span class="font-semibold">Add to Home screen</span>.</p></div>
    <div id="iosHint" class="hidden text-sm text-gray-600 max-w-xs mx-auto border border-green-300 rounded-lg p-3 bg-green-50"><p><strong>iPhone/iPad:</strong> Tap the Share icon in Safari, then choose <strong>Add to Home&nbsp;Screen</strong>.</p></div>
  </main>

  <script>
    const ua=navigator.userAgent, isIOS=/iPhone|iPad|iPod/i.test(ua), isAndroid=/Android/i.test(ua), isMobile=isIOS||isAndroid;
    const platformMsg=document.getElementById('platformMsg');
    platformMsg.textContent=isIOS?'Tap the Share icon and pick “Add to Home Screen” to install.':isAndroid?'Tap Install below or ⋮ Menu → Add to Home screen.':'Open this page on your phone to install the app.';
    if(!isMobile){document.body.innerHTML='<h2 class="text-xl font-semibold">Open this page on your mobile device to install the app.</h2>';}
    const BASE=location.pathname.replace(/\/[^/]*$/, '/');
    if(window.matchMedia('(display-mode: standalone)').matches||window.navigator.standalone){window.location.replace(BASE+'mobile/');}
    if('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
    const installBtn=document.getElementById('installBtn'),androidHint=document.getElementById('androidHint'),iosHint=document.getElementById('iosHint');
    let deferredPrompt;
    if(isAndroid) installBtn.classList.remove('hidden');
    if(isIOS) iosHint.classList.remove('hidden');
    window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt=e;if(isAndroid){installBtn.classList.remove('hidden');androidHint.classList.add('hidden');}});
    installBtn.addEventListener('click',async()=>{if(!isAndroid) return;if(deferredPrompt){deferredPrompt.prompt();const {outcome}=await deferredPrompt.userChoice;if(outcome==='accepted') installBtn.textContent='Installed!';deferredPrompt=null;}else{androidHint.classList.remove('hidden');}});
  </script>
</body>
</html>